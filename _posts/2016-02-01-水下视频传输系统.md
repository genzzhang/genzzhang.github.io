---
layout: post
title: 水下视频传输系统
date: 2016-02-01 19:52
categories: 嵌入式
tags: embedded-system
---


在养殖区中，水深一般不超过4.5米，通过观测养殖品的生长状况和水下情况可以合理投放饲料、及时处理异常情况，结合移动互联，为水下养殖提供一套轻巧便携、低成本的视频监控设备，它可为养殖户省心省工省力提高产量。

![](/assets/2016-02-01-水下视频传输系统图1.png)

以嵌入式技术为基础，结合无线传输、图像采集和网络编程等技术，按照具有摄像功能的多自由度运动水下移动平台的需求，设计一种基于嵌入式技术的水下视频实时传输系统，系统总体设计方案包括以下几个部分：
    
>1）水下移动平台运动STM32模块：由主控板、九轴姿态传感器、深度传感器、电源模块以及推进模块等组成，其中主控板，作为移动平台的运动控制中心，由微控制器STM32F103VCT6及其外围电路组成，九轴姿态传感器将三轴陀螺仪ITG3205、三轴加速度计ADXL345和三轴磁力计HMC5883L集为一体，用来获取移动平台体内温度和横摇、纵倾和航向等姿态信息，深度传感器用来获取移动平台所处的深度位置，电源模块包括直流电源、换压电路、充电电路、系统开关装置等，推进模块包括直流电机、电机驱动器和螺旋桨等。

>2）水下移动平台ARM-Linux系统模块：以ARM-Linux嵌入式系统为中心，定制Linux系统移植到ARM处理器上，硬件平台采用TQ2440开发板，USB摄像头采用中星微ZC301P。

>3）水面浮标：选用无线路由器，水下移动平台通过零浮力缆连接路由器，上位机通过WIFI接入路由器网络，三者组成一个局域网。

>4）上位机：包括PC机和移动终端，在Web浏览器中输入开发板IP地址，建立HTTP连接向Web服务器请求某个URL，服务器根据请求的内容发送HTML静态网页内容或者通过CGI接口调用相关程序动态产生数据后传送给上位机，用户可以远程调用USB摄像头实现对区域内的水下视频监控。

![](/assets/2016-02-01-水下视频传输系统图2.png)

将水下视频实时传输系统按照水上、水面和水下三个分层来展开，硬件平台包括水下移动平台和水面浮标两部分。由于水下视频实时传输系统硬件平台直接决定水下视频实时传输系统性能的好坏，为此尽量搭建或者选用技术成熟、性能可靠、兼容性强的硬件平台；浮标起着中继路由的作用，直接选用市面上的无线路由器即可；移动平台包括运动控制STM32模块和ARM-Linux系统模块两部分，运动控制模块是移动平台的载体控制单元，而ARM主要是视频采集和传输的平台。

STM32采用Keil4作为开发环境，基于V3.5标准外设库，使用Jlink-V8调试工具，编写C源码，编译烧写进STM32，亦可在线调试。

![](/assets/2016-02-01-水下视频传输系统图3.png) 

视频监控系统基于WIFI的远程视频传输，上位机加入水面浮标路由器所在的局域网，打开上位机浏览器访问Boa服务器中HTML文件，视频传输模块的测试，涉及到系统组网、USB摄像头识别和视频传输等。本模块的软件开发环境列举如下：
>1）宿主机与操作系统：Windows8.1、VMware Workstation 11、Fedora 10  
2）目标机与操作系统：Arm、Linux2.6.30.4内核  
3）交叉编译环境：arm-linux-gcc4.3.3  
4）平台交互工具：DNW、SecureCRT、FileZilla  

在上位机浏览器地址栏输入http://192.168.1.188/video.html访问Boa服务器中的网页，可以看到摄像头采集的视频实时图像。

![](/assets/2016-02-01-水下视频传输系统图4.png)
